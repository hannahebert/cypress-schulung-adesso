<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Cypress - Die Kunst der simplen E2E Tests</title>

    <link rel="stylesheet" href="node_modules/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="node_modules/reveal.js/dist/theme/dracula.css" id="theme">
    <link rel="stylesheet" href="node_modules/reveal.js/plugin/highlight/monokai.css">

    <script src="node_modules/reveal.js/plugin/markdown/markdown.js"></script>

    <style media="screen">
        .slides section.has-dark-background, k
        .slides section.has-dark-background h2 {
            color: #fff;
        }

        .slides section.has-light-background,
        .slides section.has-light-background h2 {
            color: #222;
        }

        .reveal code {
            tab-size: 0;
            -moz-tab-size: 1;
            -o-tab-size: 1;
            -webkit-tab-size: 1;
        }

        .highlight {
            color: #BD93F9;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section data-background-image="./images/stars.jpg">
            <h1>Effizientes E2E Testing mit Cypress</h1>
        </section>
        <section>
            <section data-background-image="./images/stars.jpg">
                <h2>Agenda</h2>
                <ul>
                    <li>Vorstellungsrunde</li>
                    <li>Grundlagen Testing</li>
                    <li>Cypress Intro</li>
                    <li>Cypress Übungen</li>
                </ul>
            </section>
            <section>
                <h2>Pausen</h2>
                <ul>
                    <li>09:00 - 09.50 Uhr</li>
                    <li>10:05 - 10:50 Uhr</li>
                    <li>11:05 - 12:00 Uhr</li>
                    <li>13:00 - 13:50 Uhr</li>
                    <li>14:05 - 14:50 Uhr</li>
                    <li>15:05 - 15:50 Uhr</li>
                    <li>16:05 - 17:00 Uhr</li>
                </ul>
            </section>
            <section>
                <h2>Vorstellungsrunde</h2>
                <ul>
                    <li>Name</li>
                    <li>Rolle im Projekt</li>
                    <li>Erwartungen für die Schulung</li>
                    <li>...</li>
                </ul>
            </section>
<!--            TODO menti-->
            <section data-background-image="./images/menti.png"></section>
        </section>
        <section>
            <section data-background-image="./images/stars.jpg">
                <h1>Grundlagen Testing</h1>
            </section>
            <section>
                <h2>Warum testen wir überhaupt?</h2>
            </section>
            <section>
                <div class="r-vstack">
                    <img class="r-stretch" src="images/paypal_bug.png" width="1000px"/>
                </div>
                <aside class="notes">
                    https://osxdaily.com/2011/03/13/iphone-daylight-savings-time-bug-fall-back-instead-of-spring-forward/
                </aside>
            </section>
            <section>
                <h2>5 Gründe, warum Tests unsere Nerven (und Projekte) retten</h2>
            </section>
            <section>
                <h2>Bugs möglichst früh finden</h2>
                <img class="slider-stretch" src="images/bugs-finden.png" alt="Bugs finden">
                <div class="fragment">Je früher ein Fehler gefunden wird, desto <span class="highlight">einfacher</span>,
                    <span class="highlight">schneller</span> und damit auch
                    <span class="highlight">günstiger</span> ist er zu beheben.
                </div>
            </section>
            <section>
                <h2>Regressionstests/h2>
                Deine Kolleg*innen (und dein Zukunfts-Ich) werden es dir danken, wenn sie neue Features hinzufügen
                können, ohne vorhandene kaputtzumachen.
            </section>
            <section>
                <h2>Was ist besser testbar?</h2>
                <div style="display: flex; align-items: center; justify-content: center;">
                    <img src="images/network-switch-unorganized.png" alt="Network Switch 1" style="margin-right: 20px;">
                    <h3>vs.</h3>
                    <img src="images/network-switch-organized.png" alt="Network Switch 2" style="margin-left: 20px;">
                </div>
            </section>
            <section>
                <h2>Wartbarkeit erhöhen</h2>
                <p class="fragment">Tests führen oft dazu, dass Code modular und verständlich geschrieben wird.</p>
            </section>
            <section>
                <h2>Grenzfälle abtesten</h2>
                Weil es immer jemanden gibt, der Dinge anders benutzt, als sie gedacht sind.
            </section>
            <section>
                <h2>Was sind Grenzfälle?</h2>
                <ul>
                    <li class="fragment"><span class="highlight">Ungültige Eingaben</span>: Buchstaben statt Zahlen</li>
                    <li class="fragment"><span class="highlight">Ungewöhnliche Nutzung</span>: z.B. extrem hohe oder niedrige Werte</li>
                    <li class="fragment"><span class="highlight">Ressourcenprobleme</span>: Ressource (z.B. Internetverbindung) ist nicht verfügbar.</li>
                    <li class="fragment"><span class="highlight">Leistungsgrenzen</span>: Sehr hohen Anzahl von Anfragen oder Daten</li>
                    <li class="fragment"><span class="highlight">Sicherheitslücken</span></li>
                    <li class="fragment"><span class="highlight">Kompatibilitätsprobleme</span>: Nutzung des Systems auf nicht unterstützten Geräten oder Browsern.</li>
                </ul>
            </section>
            <section>
    <pre><code class="javascript" data-line-numbers="1-9|11|12|13|14">const divide = (a, b) => {
    if (typeof a !== 'number' || typeof b !== 'number') {
        return 'Eingaben müssen Zahlen sein';
    }
    if (b === 0) {
        return 'Division durch Null ist nicht erlaubt';
    }
    return a / b;
};

console.log(divide(10, 0)); // Grenzfall: Division durch Null
console.log(divide(0, 10)); // Grenzfall: 0
console.log(divide(-10, 2)); // Grenzfall: negative Zahl
console.log(divide(10, 'a')); // Grenzfall: String als Eingabe
    </code></pre>
            </section>
            <section>
                <h2>Dokumentation</h2>
                Weil niemand Lust hat, nach einem Jahr wieder herauszufinden, was ‘doSomething()’ eigentlich tut.
            </section>
            <section><h2>Graue Theorie</h2></section>
            <section>
                <h3>Automatisiertes Testen</h3>
                <p>vs.</p>
                <h3>Manuelles Testen</h3>
            </section>
            <section>
                <h2>Manuelles Testen</h2>
                <ul>
                    <li>Zeitaufwändig</li>
                    <li>Monoton</li>
                    <li>Fehleranfällig</li>
                    <li>Subjektiv</li>
                    <li>Teuer</li>
                </ul>
            </section>
            <section>
                <h2>Automatisiertes Testen</h2>
                <ul>
                    <li>Wiederholbar</li>
                    <li>Skalierbar</li>
                    <li>Zeitersparnis</li>
                    <li>Qualitätssicherung</li>
                </ul>
            </section>
            <section>
                <h2>Testpyramide</h2>
                <img class="r-stretch" src="images/testingpyramide.png"/>
            </section>
            <section>
                <h2>Was ist Unit Testing?</h2>
                <p class="fragment">Testen von einzelnen Units</p>
                <p class="fragment">Automatisiert</p>
                <p class="fragment">Isoliert</p>
            </section>
            <section data-background-image="./images/unit.jpg">
                <h3>Was ist eine Unit?</h3>
                <p class="fragment">Der kleinste Baustein einer Applikation</p>
                <p class="fragment">Funktion/ Klasse</p>
            </section>
            <section>
                <h2>Grundannahme:</h2>
                <p>Wenn alle Units korrekt funktionieren, dann funktioniert auch die Applikation korrekt.</p>
            </section>
            <section>
                <h2>Integration Tests</h2>
                <p class="fragment">Funktionieren die einzelnen Komponenten auch im Zusammenspiel miteinander?</p>
                <video class="fragment" data-autoplay height="250px" src="videos/9zf0asd0c3n51.mp4"></video>
            </section>
            <section>
                <h2>End-To-End Tests</h2>
                <ul>
                    <li class="fragment">Simulieren das echte Nutzererlebnis</li>
                    <li class="fragment">Werden oft von speziellen QA-Teams geschrieben</li>
                    <li class="fragment">Sind teuer und haben lange Ausführungszeiten
                        > müssen sich lohnen
                    </li>
                </ul>
            </section>
            <section>
                <h2>Keine harten Grenzen</h2>
                <img class="r-stretch" src="images/keine-harten-grenzen.png"/>
            </section>
            <section>
                <h2>Und was macht Cypress?</h2>
                <img class="r-stretch" src="images/keine-harten-grenzen-cypress.png"/>
            </section>
        </section>
        <section>
            <section data-background-image="./images/stars.jpg">
                <img class="r-stretch" src="images/Cypress_Logotype_White-Color.png"/>

            </section>
            <section data-background-image="./images/vacation.jpg" class="has-dark-background">
                <h1>Developer Experience</h1>
                <h2>Die Cypress Philosophie</h2>
            </section>
            <section>
                <h2>Batteries included - Das Cypress Setup</h2>
                <ul>
                    <li class="fragment">Testing Framework: Mocha</li>
                    <li class="fragment">Assertion Library: Chai</li>
                    <li class="fragment">Launcher/ Test Runner</li>
                    <li class="fragment">Reporter</li>
                    <li class="fragment">Browser: Electron</li>
                    <li class="fragment">Proxy (für Request Stubbing)</li>
                </ul>
            </section>
            <section>
                <h2>Die Cypress Desktop App</h2>
                <ul>
                    <li class="fragment">Vereinfacht das Schreiben der Tests</li>
                    <li class="fragment">Visuell aufbereitetes Feedback</li>
                    <li class="fragment">Timetravel</li>
                    <li class="fragment">Übersichtliches Debugging</li>
                </ul>
            </section>
            <section>
                <h2>Sehr einfaches Mocking/ Stubbing</h2>
                <p>Wenn die Realität mal wieder nicht perfekt ist...</p>
            </section>
            <section>
                <h2>Wundervolle Dokumentation</h2>
                <ul>
                    <li>... um Cypress zu lernen.</li>
                    <li>... um die Best Practices zu erfahren.</li>
                    <li>... um CI aufzusetzen.</li>
                    <li>...</li>
                </ul>
            </section>
        </section>
        <section data-background-image="./images/stars.jpg">
            <section class="has-dark-background">
                <h1>Cypress Setup</h1>
            </section>
            <section>
                <pre class="bash"><code data-trim data-noescape data-line-numbers="1|2" class="hljs">
                    $ npm  install  –-save-dev  cypress
                    $ npx  cypress  open
                </code></pre>
            </section>
            <section class="has-dark-background">
                <h1>Let's see the magic</h1>
            </section>
        </section>
        <section>
            <section data-background-image="./images/stars.jpg">
                <h1>Testaufbau</h1>
            </section>
            <section>
                <pre data-id="code" class="javascript"><code data-line-numbers="1,12|2-4|6,11|7-10" class="hljs"
                >describe('login', () => {
  beforeEach(() => {
    cy.visit('http://localhost:4200/');
  })

  it('should successfully login', () => {
    cy.contains('Bingo');

    cy.get('[data-cy="login-form"]')
        .should('contain', 'Anmeldung');
  })
})
                </code></pre>
                <aside class="notes">$('.my-selector') --> jQuery</aside>
            </section>
            <section>
                <h2>Assertions vs. Commands</h2>
                <p class="fragment"><strong>Commands</strong> sind Aktionen, die auf der Seite ausgeführt werden.</p>
                <p class="fragment"><strong>Assertions</strong> sind Überprüfungen, die das Verhalten der Seite testen.
                </p>
                <pre data-id="code" class="javascript fragment"><code data-line-numbers class="hljs"
                >cy.get('my-selector')           // Command
    .should('have.length',5);   // Assertion
                </code></pre>
            </section>
            <section>
                <h2>Commands: Query vs. Non-Query</h2>
                <p class="fragment"><strong>Query</strong>: Elemente finden</p>
                <p class="fragment"><strong>Non-Query</strong>: Aktionen ausführen</p>
                <p class="fragment">=> Query Commands geben ein Element zurück, Non-Query Commands nicht.</p>


                <pre data-id="code" class="javascript fragment"><code data-line-numbers class="hljs"
                >cy.get('button')       // Query Command
    .click();         // Non-Query Command
                </code></pre>
            </section>
        </section>
        <section>
            <h1>Übung 1: Login</h1>
            <h2>Zum Repo auf GitHub</h2>
            <img class="r-stretch" src="images/qr-code-repo.png"/>
            <p>https://github.com/hannahebert/cypress-schulung-adesso</p>
        </section>
        <section>
            <h2>Get vs. Find vs. contains </h2>
            <p><strong>cy.get()</strong> - Findet ein Element</p>
            <p><strong>cy.find()</strong> - Findet ein Kind-Element</p>
            <p><strong>cy.contains()</strong> - Findet ein Element anhand des Textes</p>

            <pre data-id="code" class="javascript fragment"><code data-line-numbers class="hljs"
            >cy.contains('Bingo');

cy.get('[data-cy="login-form"]')
    .find('h3')
    .should('contain', 'Anmeldung');
                </code></pre>
        </section>

        <section>
            <h1>Übung 2: Bingo</h1>
        </section>

        <section>
            <section>
                <h2>Custom Cypress Command: Login</h2>
                <pre><code class="typescript" data-line-numbers="1-2,17|3-12|13-14|16"
                >Cypress.Commands.add('login',(username: string,
                    password: string): void => {
  cy.visit('login');
  cy.get('[data-cy="username"]')
    .type('cypress', {log: false});
  cy.get('[data-cy="password"]')
    .type('bingo', {log: false});

  cy.get('[data-cy="submit-button"]')
    .click()
    .should('not.exist');

  cy.url()
    .should('eq', `${Cypress.config().baseUrl}/bingo-board`);

  cy.get('.board-title').should('have.text', 'Bingo');
});
    </code></pre>
            </section>
        </section>

        <section>
            <h1>Übung 3: Custom Command</h1>
        </section>

        <section>
            <section>
                <h2>Chain of Commands - Retry Logic</h2>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript fragment"><code data-line-numbers class="hljs"
                >cy.get('my-selector')
    .should('have.length',5)
    .eq(1)
    .should('contain', 'magic');
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers class="hljs"
                >cy.get('my-selector')
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript">
                    <code data-line-numbers="2" class="hljs"
                    >cy.get('my-selector')
    .should('have.length',5)    // FAIL
                    </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers class="hljs"
                >cy.get('my-selector')
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript">
                    <code data-line-numbers="2" class="hljs"
                    >cy.get('my-selector')
    .should('have.length',5)
                    </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="3" class="hljs"
                >cy.get('my-selector')
    .should('have.length',5)
    .eq(1)
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="4" class="hljs"
                >cy.get('my-selector')
    .should('have.length',5)
    .eq(1)
    .should('contain', 'magic');
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="4" class="hljs"
                >cy.get('my-selector')
    .should('have.length',5)
    .eq(1)
    .should('contain', 'magic'); // FAIL
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers class="hljs"
                >cy.get('my-selector')
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="2" class="hljs"
                >cy.get('my-selector')
    .should('have.length',5)
                </code></pre>
            </section>
            <section data-auto-animate>
                <h2>Chain of Commands - Retry Logic</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="3" class="hljs"
                >cy.get('my-selector')
    .should('have.length',5)
    ...
                </code></pre>
            </section>
        </section>

        <section>
            <h1>Übung 4: Screenshot & Video</h1>
        </section>

        <section>
            <section>
                <h1>cy.request vs cy.intercept</h1>
            </section>
            <section>
                <h2>cy.request – Direkt API testen</h2>
                <p><strong>Zweck:</strong> HTTP-Anfragen direkt senden und prüfen.</p>
                <p><strong>Einsatzgebiet:</strong></p>
                <ul>
                    <li>Backend-APIs testen</li>
                    <li>Testdaten vorbereiten (z. B. Benutzer erstellen)</li>
                    <li>Systemzustände prüfen</li>
                </ul>
            </section>
            <section>
                <h2>cy.request – Beispiel</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="1,2|3,6|4,5" class="hljs"
                >cy.request('POST', '/api/login',
                    { username: 'test', password: 'test123' })
  .then((response) => {
    expect(response.status).to.eq(200);
    expect(response.body).to.have.property('token');
  });
                </code></pre>
            </section>
            <section>
                <h2>cy.intercept – Netzwerkanfragen steuern</h2>
                <p><strong>Zweck:</strong></p>
                <ul>
                    <li>Anfragen abfangen und Stub- oder Mock-Daten verwenden</li>
                    <li>Netzwerkverkehr überwachen</li>
                </ul>
                <p><strong>Einsatzgebiet:</strong></p>
                <ul>
                    <li>API-Fehler simulieren</li>
                    <li>Tests isolieren (kein echter Backend-Aufruf)</li>
                    <li>Frontend-Integration testen</li>
                </ul>
            </section>
            <section>
                <h2>cy.intercept – Beispiel</h2>
                <pre data-id="code" class="javascript"><code data-line-numbers="1,2|4|5,7|6" class="hljs"
                >cy.intercept('GET', '/api/data', { fixture: 'data.json' })
                    .as('getData');

cy.visit('/dashboard');
cy.wait('@getData').then((interception) => {
  expect(interception.response.statusCode).to.eq(200);
});
                </code></pre>
                <pre>

    </pre>
            </section>
            <section>
                <h2>cy.request vs cy.intercept</h2>
                <table>
                    <tr>
                        <th>Merkmal</th>
                        <th>cy.request</th>
                        <th>cy.intercept</th>
                    </tr>
                    <tr>
                        <td>Zweck</td>
                        <td>Direkte HTTP-Anfragen senden</td>
                        <td>Anfragen abfangen und manipulieren</td>
                    </tr>
                    <tr>
                        <td>Browser-Interaktion</td>
                        <td>Nicht erforderlich</td>
                        <td>Browser-basiert</td>
                    </tr>
                    <tr>
                        <td>Mocking möglich?</td>
                        <td>Nein</td>
                        <td>Ja</td>
                    </tr>
                    <tr>
                        <td>Anwendungsbereich</td>
                        <td>API-Tests, Datenvorbereitung</td>
                        <td>Überwachen, Stubben, Mocking von Requests</td>
                    </tr>
                </table>
            </section>
        </section>

        <section data-background-image="./images/stars.jpg">
            <section>
                <h2>Best Practices</h2>
            </section>
            <section>
                <h2>Resiliente Tests</h2>
                <p>Verwende stabile Selectoren (z.B. `data-cy`), um auf UI-Elemente zuzugreifen.</p>
            </section>
            <section>
                <h2>Schreibe unabhängige Tests</h2>
                <p>Tests sollten isoliert und unabhängig voneinander sein.</p>
            </section>
            <section>
                <h2>DRY - Don't repeat yourself (too often)</h2>
                <p>Verwende Custom Commands - Erstelle wiederverwendbare Befehle für häufige Aktionen, um den Testcode
                    zu vereinfachen.</p>
            </section>
            <section>
                <h1>Aber</h1>
                <h2>KISS - Keep It Simple Stupid</h2>
                <p>Nicht alles muss in ein Command - Halte die Tests so einfach wie möglich, um die Wartbarkeit zu
                    erhöhen.</p>
            </section>
            <section>
                <h2>Nutze `cy.fixture()` für Testdaten</h2>
                <p>Lade Testdaten aus externen Dateien, um die Tests sauber und wartbar zu halten.</p>
            </section>
            <section>
                <h2>Nutze `cy.intercept()` für API-Stubbing</h2>
                <p>Simuliere API-Antworten, um Tests schneller und zuverlässiger zu machen.</p>
            </section>
            <section>
                <h2>Setze den Zustand vor jedem Test zurück</h2>
                <p> ..., um Seiteneffekte zu vermeiden (`beforeEach`).</p>
            </section>
            <section>
                <h2>Verwende `cy.wait()` nur, wenn es WIRKLICH nötig ist</h2>
            </section>
            <section>
                <h2>Halte deine Testdaten realistisch und aktuell.</h2>
            </section>
        </section>
    </div>
</div>

<script src="node_modules/reveal.js/dist/reveal.js"></script>
<script src="node_modules/reveal.js/plugin/notes/notes.js"></script>
<script src="node_modules/reveal.js/plugin/highlight/highlight.js"></script>
<script>
    Reveal.initialize({
        slideNumber: true,
        autoPlayMedia: true,
        plugins: [RevealNotes, RevealHighlight],
    });
</script>
</body>
</html>